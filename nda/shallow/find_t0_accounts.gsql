
#single pass agg
use graph MyGraph
drop query FIND_T0_ACCOUNTS 
CREATE QUERY FIND_T0_ACCOUNTS() Syntax V2{

  SetAccum<vertex> @@risky_accounts;
  SetAccum<edge> @@risky_orders;

  t0 =
    SELECT s
    FROM Account:s -(send_bonus>:e) - Account:t
    WHERE s.reg_date == e.order_date
    ACCUM @@risky_accounts += s,
          @@risky_orders += e;

  PRINT @@risky_accounts AS accounts,
        @@risky_orders AS orders;
}
