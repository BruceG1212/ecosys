USE GRAPH ldbc_snb
DROP QUERY to_jsonarray

CREATE QUERY to_jsonarray(SetAccum<string> src) FOR GRAPH ldbc_snb RETURNS(jsonarray) {
  string tgt = "[";
  bool isFirst = True;

	FOREACH s IN src DO
    IF NOT isFirst THEN
      tgt += ","+s;
    ELSE
      tgt += s;
      isFirst = False;
    END;
  END;
  tgt += "]"

  RETURN parse_json_array(tgt);
}

INSTALL QUERY to_jsonarray